<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="manifest" href="manifest.json" />
	<!-- <script async src="https://cdn.jsdelivr.net/npm/pwacompat@2.0.8/pwacompat.min.js"
        integrity="sha384-uONtBTCBzHKF84F6XvyC8S0gL8HTkAPeCyBNvfLfsqHh+Kd6s/kaS4BdmNQ5ktp1"
        crossorigin="anonymous"></script> -->
    <script async src="js/pwacompat.min.js"></script>
    <script src="main.js" type="module"></script>
    <title>PWA с отправкой push уведомлений</title>
</head>
<body>
    <!-- Ваш контент страницы -->
    <h1>Time</h1>

<button id="pushButton">Включить уведомления</button>

    <script>
        document.getElementById('pushButton').addEventListener('click', function() {
            Notification.requestPermission().then(function(permission) {
                if (permission === 'granted') {
                    console.log('Разрешение на уведомления получено.');
                }
            });
        });
    </script>


    <script>
        if ('serviceWorker' in navigator && 'PushManager' in window) {
            window.addEventListener('load', async () => {
                const swRegistration = await navigator.serviceWorker.register('sw.js');
                await navigator.serviceWorker.ready;

                const permission = await Notification.requestPermission();
                if (permission === 'granted') {
                    const pushSubscription = await swRegistration.pushManager.subscribe({ userVisibleOnly: true });
                    console.log('Push уведомления включены');
                } else {
                    console.error('Отказано в разрешении на отправку push уведомлений');
                }
            });
        }
    </script>
</body>
</html>
