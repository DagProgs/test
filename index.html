<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Qibla Compass</title>
<style>
  .compass {
    width: 200px;
    height: 200px;
    border: 5px solid black;
    border-radius: 50%;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    transition: transform 0.5s;
  }
</style>
</head>
<body>
<div id="app">
  <div class="compass" :style="{ transform: 'rotate(' + qiblaDirection + 'deg)'}"></div>
</div>
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.11/dist/vue.min.js"></script>
<script>
new Vue({
  el: '#app',
  data: {
    qiblaDirection: 0, // Начальное направление к qibla
  },
  mounted() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition((position) => {
        let latitude = position.coords.latitude;
        let longitude = position.coords.longitude;
        let kaabaLatitude = 21.4225; // Координаты Каабы
        let kaabaLongitude = 39.8262;

        let phiK = kaabaLatitude * Math.PI / 180;
        let lambdaK = kaabaLongitude * Math.PI / 180;
        let phi = latitude * Math.PI / 180;
        let lambda = longitude * Math.PI / 180;
        
        let y = Math.sin(lambdaK - lambda);
        let x = Math.cos(phi) * Math.tan(phiK) - Math.sin(phi) * Math.cos(lambdaK - lambda);
        
        let qibla = Math.atan2(y, x) * 180 / Math.PI;
        this.qiblaDirection = qibla;
      });
    } else {
      alert("Ваш браузер не поддерживает геолокацию");
    }
  }
});
</script>
</body>
</html>
