<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Qibla Compass</title>
<style>
  .compass {
    width: 200px;
    height: 200px;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) rotate(0deg);
    transition: transform 0.5s;
  }
  .arrow {
    width: 10px;
    height: 40px;
    background: black;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -100%) rotate(0deg);
  }
</style>
</head>
<body>
<div id="app">
  <div class="compass">
    <div class="arrow"></div>
    <img src="https://i.imgur.com/DV6E958.png" alt="Qibla Compass">
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.11/dist/vue.min.js"></script>
<script>
new Vue({
  el: '#app',
  data: {
    qiblaDirection: 0, // Начальное направление к qibla
  },
  mounted() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition((position) => {
        let latitude = position.coords.latitude;
        let longitude = position.coords.longitude;
        let kaabaLatitude = 21.4225; // Координаты Каабы
        let kaabaLongitude = 39.8262;

        let y = Math.sin(longitude - kaabaLongitude);
        let x = Math.cos(kaabaLatitude) * Math.tan(latitude) - Math.sin(kaabaLatitude) * Math.cos(longitude - kaabaLongitude);
        
        let qibla = Math.atan2(y, x) * 180 / Math.PI;
        qibla = qibla >= 0 ? qibla : (qibla + 360);
        this.qiblaDirection = -qibla; // Делаем обратный поворот, так как 0 градусов находится на верху
        document.querySelector('.arrow').style.transform = `translate(-50%, -100%) rotate(${qibla}deg)`;
      });
    } else {
      alert("Ваш браузер не поддерживает геолокацию");
    }
  }
});
</script>
</body>
</html>
